<!DOCTYPE html>
<html dir="ltr" lang="zxx">
  <head>
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <meta charset="utf-8" />
    <meta
      name="keywords"
      content="army, aviation, commando, community, donation, guard, military, navy, officer, recruiting, security, service, squad, veterans, war"
    />
    <meta name="author" content="ThemeEarth" />

    <title>Dragonborn - PMC</title>
    <link rel="icon" type="image/png" href="images/favicon.ico" />

    <link rel="apple-touch-icon" href="images/logo/apple-touch-icon.png" />
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="images/logo/apple-touch-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="images/logo/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="images/logo/apple-touch-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="images/logo/apple-touch-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="images/logo/apple-touch-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="images/logo/apple-touch-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="images/logo/apple-touch-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="images/logo/apple-touch-icon-180x180.png"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/fontawesome.min.css" />
    <link rel="stylesheet" href="css/magnific-popup.css" />
    <link rel="stylesheet" href="css/slick.css" />
    <link rel="stylesheet" href="css/meanmenu.css" />
    <link rel="stylesheet" href="css/nice-select.css" />
    <link rel="stylesheet" href="css/animate.css" />
    <link rel="stylesheet" href="css/style.css" />

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style>
      th {
        background-color: #7f0605 !important;
        color: white;
        vertical-align: middle;
      }

      td {
        vertical-align: middle;
      }

      a:hover {
        color: #7f0605 !important;
      }

      .contact-text span {
        color: white !important;
      }

      .contact-text span:hover {
        color: #7f0605 !important;
      }

      .te-submenu {
        border-top: 2px solid #7f0605 !important;
      }

      .te-logo-text:hover {
        color: "#ff4d24";
      }

      .te-slider-label {
        color: #7f0605 !important;
      }

      .te-theme-btn {
        background-color: #7f0605;
        border: none;
      }
    </style>
  </head>

  <body>
    <!-- Preloader Start !-->
    <div id="preloader">
      <div class="preloader-image">
        <img src="images/icon/preloader.gif" alt="preeloader" />
      </div>
      <div class="loader">
        <div class="row">
          <div class="col-3 loader-area">
            <div class="loader-bg"></div>
          </div>
          <div class="col-3 loader-area">
            <div class="loader-bg"></div>
          </div>
          <div class="col-3 loader-area">
            <div class="loader-bg"></div>
          </div>
          <div class="col-3 loader-area">
            <div class="loader-bg"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Preloader End !-->
    <!-- Header Start !-->
    <header class="header-area style-3">
      <!-- Header Top Start -->
      <!-- Header Top End -->

      <!-- Header Nav Menu Start -->
      <div class="te-header-menu-area te-sticky-header te-sticky_menu">
        <div class="container">
          <div class="container">
            <div class="row menu-wrapper">
              <div
                class="col-xl-3 col-lg-3 col-md-6 col-6 d-flex align-items-center"
              >
                <div class="te-logo">
                  <a
                    href="index.html"
                    class="te-standard-logo"
                    style="display: flex; align-items: center"
                  >
                    <img
                      src="https://tr.rbxcdn.com/180DAY-381e7542884a99021da16cda8bc55246/150/150/Image/Webp/noFilter"
                      alt="Dragonborn logo."
                      style="width: 50px"
                    />
                    <span
                      className="te-logo-text"
                      style="color: white; font-size: 30px; font-weight: bold"
                      >DRAGONBORN</span
                    >
                  </a>
                </div>
              </div>
              <div
                class="col-xl-9 col-lg-9 col-md-6 col-6 d-flex align-items-center justify-content-end"
              >
                <div class="te-menu d-inline-block">
                  <nav id="main-menu" class="te-main-menu">
                    <ul>
                      <li><a href="index.html">Home</a></li>
                      <li class="te-dropdown">
                        <a href="#">Organization</a>
                        <ul class="te-submenu">
                          <li>
                            <a href="hierarchy.html">Dragonborn Hierarchy</a>
                          </li>
                          <li>
                            <a href="ranks.html">Dragonborn Ranks</a>
                          </li>
                          <li>
                            <a href="codex.html">Dragonborn Codex</a>
                          </li>
                        </ul>
                      </li>
                      <li class="te-dropdown">
                        <a href="#">Registries</a>
                        <ul class="te-submenu">
                          <li><a href="blacklists.html">Blacklists</a></li>
                          <li>
                            <a href="suspensions.html">Suspensions</a>
                          </li>
                          <li>
                            <a href="bans.html">Global Bans</a>
                          </li>
                          <li>
                            <a href="auditlogs.html">Audit Logs</a>
                          </li>
                        </ul>
                      </li>
                      <li class="te-dropdown">
                        <a href="#">About Us</a>
                        <ul class="te-submenu">
                          <li><a href="faq.html">FAQ Page</a></li>
                          <li>
                            <a
                              href="https://discord.gg/WR4K4v5vXX"
                              target="_blank"
                              >Join Us</a
                            >
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </nav>
                </div>
                <!-- Mobile Menu Toggle Button Start !-->
                <div class="te-mobile-menu-bar d-xl-none text-end">
                  <a href="#" class="te-mobile-menu-toggle-btn"
                    ><i class="fal fa-bars"></i
                  ></a>
                </div>
                <!-- Mobile Menu Toggle Button End !-->
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Header Nav Menu End -->
    </header>
    <!-- Header End !-->
    <!-- Menu sidebar Section Start -->
    <div class="te-menu-sidebar-area">
      <div class="te-menu-sidebar-wrapper">
        <div class="te-menu-sidebar-close">
          <button class="te-menu-sidebar-close-btn" id="menu_sidebar_close_btn">
            <i class="fal fa-times"></i>
          </button>
        </div>
        <div class="te-menu-sidebar-content">
          <div class="te-logo">
            <a
              href="index.html"
              class="te-standard-logo"
              style="display: flex; align-items: center"
            >
              <img
                src="https://tr.rbxcdn.com/180DAY-381e7542884a99021da16cda8bc55246/150/150/Image/Webp/noFilter"
                alt="Dragonborn logo."
                style="width: 50px"
              />
              <span
                className="te-logo-text"
                style="color: white; font-size: 30px; font-weight: bold"
                >DRAGONBORN</span
              >
            </a>
          </div>
          <div class="te-mobile-nav-menu"></div>
        </div>
      </div>
    </div>
    <!-- Menu sidebar Section Start -->
    <div class="te-body-overlay"></div>

    <div class="container" style="margin-top: 150px; text-align: center">
      <h2>Banned Players</h2>

      <!-- Search Bar -->
      <div class="search-bar" style="margin-bottom: 20px">
        <input
          type="text"
          id="searchInput"
          class="form-control mt-3 bg-dark text-light border-dark"
          placeholder="Search by username or ID"
        />
      </div>

      <!-- Table -->
      <!-- Table Container -->
      <div class="table-responsive">
        <table class="table table-dark table-striped text-center">
          <thead class="custom-header">
            <tr>
              <th>Avatar</th>
              <th>Roblox Name</th>
              <th>Roblox ID</th>
              <th>Category</th>
              <th>Reason</th>
              <th>Evidence</th>
              <th>Issued By</th>
              <th>Issued Date</th>
            </tr>
          </thead>
          <tbody id="blacklistTable">
            <tr>
              <td colspan="10" class="text-center">Loading...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!--- Start Footer !-->
    <footer
      class="footer style-1 background-gray-700"
      style="margin-top: 100px"
    >
      <div class="te-footer-sec">
        <div class="container">
          <div class="row gy-5">
            <div class="col-xl-3 col-lg-6 col-md-6 te-footer-widget-wrapper">
              <div class="te-footer-widget">
                <div class="te-footer-widget-info">
                  <div class="te-footer-logo">
                    <a
                      href="index.html"
                      class="te-standard-logo"
                      style="display: flex; align-items: center"
                    >
                      <img
                        src="https://tr.rbxcdn.com/180DAY-381e7542884a99021da16cda8bc55246/150/150/Image/Webp/noFilter"
                        alt="Dragonborn logo."
                        style="width: 50px"
                      />
                      <span
                        className="te-logo-text"
                        style="color: white; font-size: 30px; font-weight: bold"
                        >DRAGONBORN</span
                      >
                    </a>
                  </div>
                  <p>
                    Managed by the systems administrator. Please contact if
                    there are any issues within this site.
                  </p>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-6 col-md-6 te-footer-widget-wrapper">
              <div class="te-footer-widget">
                <h3 class="te-footer-widget-title">CONTACT US</h3>

                <div class="te-footer-widget-contact">
                  <div class="footer-contact">
                    <ul>
                      <li>
                        <div class="contact-icon">
                          <i
                            class="fa-brands fa-discord"
                            style="color: #7f0605"
                          ></i>
                        </div>
                        <div class="contact-text">
                          <a
                            href="https://discord.gg/WR4K4v5vXX"
                            target="_blank"
                            ><span>Recruitment Discord Server</span></a
                          >
                        </div>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-6 col-md-6 te-footer-widget-wrapper">
              <div class="te-footer-widget te_widget_nav_menu">
                <h3 class="te-footer-widget-title">GROUPS</h3>
                <ul class="menu">
                  <li>
                    <a
                      href="https://www.roblox.com/communities/4760223/Dragonborn-PMC#!/about"
                      target="_blank"
                      >Dragonborn - PMC</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/communities/14737199/DB-Officer-Core"
                      target="_blank"
                      >Dragonborn | Officer Core</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/communities/34873618/nfernum"
                      target="_blank"
                      >Infernum</a
                    >
                  </li>
                </ul>
              </div>
            </div>

            <div class="col-xl-3 col-lg-6 col-md-6 te-footer-widget-wrapper">
              <div class="te-footer-widget te_widget_nav_menu">
                <h3 class="te-footer-widget-title">Experiences</h3>
                <ul class="menu">
                  <li>
                    <a
                      href="https://www.roblox.com/games/refer?PlaceId=5604438348&PageType=GroupDetail&LocalTimestamp=%7BlocalTimestamp%7D"
                      target="_blank"
                      >[RAID] Dragon's Nest</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/games/refer?PlaceId=5932717195&PageType=GroupDetail&LocalTimestamp=%7BlocalTimestamp%7D"
                      target="_blank"
                      >[RAID] Mythical Skies</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/games/refer?PlaceId=9226134504&PageType=GroupDetail&LocalTimestamp=%7BlocalTimestamp%7D"
                      target="_blank"
                      >[RAID] Basilisk</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/games/refer?PlaceId=12912435611&PageType=GroupDetail&LocalTimestamp=%7BlocalTimestamp%7D"
                      target="_blank"
                      >[RAID] Citadel</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/games/refer?PlaceId=5625755633&PageType=GroupDetail&LocalTimestamp=%7BlocalTimestamp%7D"
                      target="_blank"
                      >[RALLY] Pantheon</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/games/refer?PlaceId=18832649974&PageType=GroupDetail&LocalTimestamp=%7BlocalTimestamp%7D"
                      target="_blank"
                      >[RAID] Snowfall</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/games/refer?PlaceId=11702958883&PageType=GroupDetail&LocalTimestamp=%7BlocalTimestamp%7D"
                      target="_blank"
                      >[RAID] Dunes</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/games/refer?PlaceId=16315665693&PageType=GroupDetail&LocalTimestamp=%7BlocalTimestamp%7D"
                      target="_blank"
                      >[RAID] Draconic Ruins</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/games/refer?PlaceId=102632926123138&PageType=GroupDetail&LocalTimestamp=%7BlocalTimestamp%7D"
                      target="_blank"
                      >[SPAR] Colosseum</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://www.roblox.com/games/refer?PlaceId=114719237560820&PageType=GroupDetail&LocalTimestamp=%7BlocalTimestamp%7D"
                      target="_blank"
                      >[RAID] Drakos Estate</a
                    >
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom-area">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="te-footer-bottom-wrapper">
                <div class="te-copyright-text">
                  <p>
                    &copy; <a href="#">Dragonborn</a>
                    <script>
                      document.write(new Date().getFullYear());
                    </script>
                    | All Rights Reserved
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!--- End Footer !-->

    <!-- Scroll Up Section Start -->
    <div class="progress-wrap">
      <svg
        class="progress-circle svg-content"
        width="100%"
        height="100%"
        viewBox="-1 -1 102 102"
      >
        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" />
      </svg>
    </div>
    <!-- Scroll Up Section End -->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/slick.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/waypoints.js"></script>
    <script src="js/jquery.meanmenu.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/inview.min.js"></script>
    <script src="js/wow.js"></script>
    <script src="js/tilt.jquery.js"></script>
    <script src="js/isotope.min.js"></script>
    <script src="js/scrolltotop.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/custom.js"></script>
    <script>
      // Search functionality
      $(document).ready(function () {
        $("#searchInput").on("keyup", function () {
          var value = $(this).val().toLowerCase();
          var isNumber = !isNaN(value); // Check if the input is a number (ID)

          $("#blacklistTable tr").filter(function () {
            var username = $(this).find("td:nth-child(2)").text().toLowerCase();
            var robloxId = $(this).find("td:nth-child(3)").text();

            if (isNumber) {
              // Search by Roblox ID
              $(this).toggle(robloxId.indexOf(value) > -1);
            } else {
              // Search by Username
              $(this).toggle(username.indexOf(value) > -1);
            }
          });
        });
      });
    </script>
    <script type="module">
      // Import Firebase and Firestore modules
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js";
      import {
        getFirestore,
        collection,
        getDocs,
      } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js";

      // Your Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyC16tgXpKoKIzh1Aa7qp2pIBWfsxUJVsn4",
        authDomain: "dragonborn-pmc.firebaseapp.com",
        projectId: "dragonborn-pmc",
        storageBucket: "dragonborn-pmc.firebasestorage.app",
        messagingSenderId: "431690118301",
        appId: "1:431690118301:web:bc67cb59d65c73d4821074",
        measurementId: "G-3511KPRS90",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      // Proxy URL for Roblox API (group & user data)
      const proxyURL = "https://dragonborn-proxy.vercel.app/api"; // Replace with your deployed proxy URL

      // Function to fetch Roblox Group Name using Proxy
      async function fetchUsername(userId) {
        try {
          const response = await fetch(`${proxyURL}/user?userId=${userId}`);
          const data = await response.json();
          return data.username || "Unknown User";
        } catch (error) {
          console.error("Error fetching username:", error);
          return "Unknown User";
        }
      }

      async function fetchAvatar(userId) {
        try {
          const response = await fetch(`${proxyURL}/avatar?userId=${userId}`);
          const data = await response.json();
          return data.avatarUrl || "Unknown User";
        } catch (error) {
          console.error("Error fetching username:", error);
          return "Unknown User";
        }
      }

      function isValidUrl(str) {
        const pattern = /^(https?:\/\/[^\s$.?#].[^\s]*)$/i; // Regex for URL validation
        return pattern.test(str);
      }

      // Fetch and populate blacklist data into the table
      document.addEventListener("DOMContentLoaded", async () => {
        const tableBody = document.getElementById("blacklistTable");

        try {
          // Set the loading message while fetching the data
          tableBody.innerHTML = `<tr><td colspan="10" class="text-center">Loading...</td></tr>`;

          // Fetch the blacklist data from Firestore
          const querySnapshot = await getDocs(collection(db, "bans"));

          let suspensionData = [];

          // Loop through each document in the collection
          for (const doc of querySnapshot.docs) {
            const data = doc.data();
            const groupId = data.roblox_id;

            // Fetch group name asynchronously using the Proxy
            let groupName = await fetchUsername(groupId);
            let groupIcon = await fetchAvatar(groupId);

            // Push the data into an array
            suspensionData.push({
              groupIcon: groupIcon,
              groupName: groupName,
              groupId: groupId,
              category: data.category,
              reason: data.reason,
              link: data.link,
              issued_by: data.issued_by,
              issued_date: data.issued_date,
            });
          }

          // Sort the blacklist data by the issued_date in descending order
          suspensionData.sort(
            (a, b) => b.issued_date.toDate() - a.issued_date.toDate()
          );

          tableBody.innerHTML = ""; // Clear loading message

          // Loop through the sorted blacklist data and create the table rows
          suspensionData.forEach((data) => {
            const row = `
          <tr>
            <td><img src="${
              data.groupIcon
            }" style="width: 50px" alt="Avatar" /></td>
            <td>${data.groupName}</td> <!-- Group Name -->
            <td>${data.groupId}</td> <!-- Group ID -->
            <td>${data.category}</td>
            <td>${data.reason}</td>
            <td>
              ${
                isValidUrl(data.link)
                  ? `<a href="${data.link}" target="_blank">Link</a>`
                  : "No evidence provided"
              }
            </td>
            <td>${data.issued_by}</td>
            <td>${data.issued_date.toDate().toLocaleDateString()}</td>
          </tr>
        `;
            tableBody.innerHTML += row;
          });
        } catch (error) {
          console.error("Error fetching blacklist data:", error);
          tableBody.innerHTML = `<tr><td colspan="10" class="text-center">Failed to load data. Please try again later.</td></tr>`;
        }
      });
    </script>
  </body>
</html>
